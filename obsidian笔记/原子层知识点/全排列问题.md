
å³ç»™å®šä¸€ä¸ªé›†åˆï¼Œç»™å‡ºæ‰€æœ‰çš„æ’åˆ—æƒ…å†µ
è§£æ³•æ˜¯[[å›æº¯ç®—æ³•ğŸ¸]]
### æ— é‡å¤å…ƒç´ æ—¶

ä¸ºäº†å®ç°æ¯ä¸ªå…ƒç´ åªè¢«é€‰æ‹©ä¸€æ¬¡ï¼Œæˆ‘ä»¬**ä¸ç”¨**åœ¨æ¯æ¬¡é€‰æ‹©æ—¶éƒ½æ£€æµ‹æœ¬æ¬¡çš„å…ƒç´ æ˜¯å¦åœ¨å·²æ’åˆ—çš„æ•°å­—ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘å¼•å…¥ä¸€ä¸ªå¸ƒå°”å‹æ•°ç»„Â `selected`Â ï¼Œå…¶ä¸­Â `selected[i]`Â è¡¨ç¤ºÂ `choices[i]`Â æ˜¯å¦å·²è¢«é€‰æ‹©ï¼Œå¹¶åŸºäºå®ƒå®ç°ä»¥ä¸‹å‰ªææ“ä½œã€‚


```cpp
/* å›æº¯ç®—æ³•ï¼šå…¨æ’åˆ— I */
void backtrack(vector<int> &state, const vector<int> &choices, vector<bool> &selected, vector<vector<int>> &res) {
    // å½“çŠ¶æ€é•¿åº¦ç­‰äºå…ƒç´ æ•°é‡æ—¶ï¼Œè®°å½•è§£
    if (state.size() == choices.size()) {
        res.push_back(state);
        return;
    }
    // éå†æ‰€æœ‰é€‰æ‹©
    for (int i = 0; i < choices.size(); i++) {
        int choice = choices[i];
        // å‰ªæï¼šä¸å…è®¸é‡å¤é€‰æ‹©å…ƒç´ 
        if (!selected[i]) {
            // å°è¯•ï¼šåšå‡ºé€‰æ‹©ï¼Œæ›´æ–°çŠ¶æ€
            selected[i] = true;
            state.push_back(choice);
            // è¿›è¡Œä¸‹ä¸€è½®é€‰æ‹©
            backtrack(state, choices, selected, res);
            // å›é€€ï¼šæ’¤é”€é€‰æ‹©ï¼Œæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€
            selected[i] = false;
            state.pop_back();
        }
    }
}

/* å…¨æ’åˆ— I */
vector<vector<int>> permutationsI(vector<int> nums) {
    vector<int> state;
    vector<bool> selected(nums.size(), false);
    vector<vector<int>> res;
    backtrack(state, nums, selected, res);
    return res;
}
```


### æœ‰é‡å¤å…ƒç´ æ—¶
éœ€è¦è¿›è¡Œ**ç›¸ç­‰å…ƒç´ å‰ªæ**ï¼Œå³åœ¨æœ¬æ¬¡éå†å¯èƒ½æ€§æ—¶ï¼Œå¯¹äºé‡å¤çš„å…ƒç´ ï¼Œåªéå†ä¸€æ¬¡
![å‰ªæ](https://www.hello-algo.com/chapter_backtracking/permutations_problem.assets/permutations_ii_pruning.png)
åœ¨ä¸Šä¸€é¢˜çš„ä»£ç çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è€ƒè™‘åœ¨æ¯ä¸€è½®é€‰æ‹©ä¸­å¼€å¯ä¸€ä¸ªå“ˆå¸Œé›†åˆÂ `duplicated`Â ï¼Œç”¨äºè®°å½•è¯¥è½®ä¸­å·²ç»å°è¯•è¿‡çš„å…ƒç´ ï¼Œå¹¶å°†é‡å¤å…ƒç´ å‰ªæ
```cpp
/* å›æº¯ç®—æ³•ï¼šå…¨æ’åˆ— II */
void backtrack(vector<int> &state, const vector<int> &choices, vector<bool> &selected, vector<vector<int>> &res) {
    // å½“çŠ¶æ€é•¿åº¦ç­‰äºå…ƒç´ æ•°é‡æ—¶ï¼Œè®°å½•è§£
    if (state.size() == choices.size()) {
        res.push_back(state);
        return;
    }
    // éå†æ‰€æœ‰é€‰æ‹©
    unordered_set<int> duplicated;
    for (int i = 0; i < choices.size(); i++) {
        int choice = choices[i];
        // å‰ªæï¼šä¸å…è®¸é‡å¤é€‰æ‹©å…ƒç´  ä¸” ä¸å…è®¸é‡å¤é€‰æ‹©ç›¸ç­‰å…ƒç´ 
        if (!selected[i] && duplicated.find(choice) == duplicated.end()) {
            // å°è¯•ï¼šåšå‡ºé€‰æ‹©ï¼Œæ›´æ–°çŠ¶æ€
            duplicated.emplace(choice); // è®°å½•é€‰æ‹©è¿‡çš„å…ƒç´ å€¼
            selected[i] = true;
            state.push_back(choice);
            // è¿›è¡Œä¸‹ä¸€è½®é€‰æ‹©
            backtrack(state, choices, selected, res);
            // å›é€€ï¼šæ’¤é”€é€‰æ‹©ï¼Œæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€
            selected[i] = false;
            state.pop_back();
        }
    }
}

/* å…¨æ’åˆ— II */
vector<vector<int>> permutationsII(vector<int> nums) {
    vector<int> state;
    vector<bool> selected(nums.size(), false);
    vector<vector<int>> res;
    backtrack(state, nums, selected, res);
    return res;
}
```

### æ•ˆç‡åˆ†æ
å‡è®¾å…ƒç´ ä¸¤ä¸¤ä¹‹é—´äº’ä¸ç›¸åŒï¼Œåˆ™Â nÂ ä¸ªå…ƒç´ å…±æœ‰Â n!Â ç§æ’åˆ—ï¼ˆé˜¶ä¹˜ï¼‰ï¼›åœ¨è®°å½•ç»“æœæ—¶ï¼Œéœ€è¦å¤åˆ¶é•¿åº¦ä¸ºÂ nÂ çš„åˆ—è¡¨ï¼Œä½¿ç”¨$O(n)$Â æ—¶é—´ã€‚**å› æ­¤æ—¶é—´å¤æ‚åº¦ä¸ºÂ $O(n!n)$**Â ã€‚

æœ€å¤§é€’å½’æ·±åº¦ä¸ºÂ nÂ ï¼Œä½¿ç”¨Â O(n)Â æ ˆå¸§ç©ºé—´ã€‚`selected`Â ä½¿ç”¨Â $O(n)$Â ç©ºé—´ã€‚åŒä¸€æ—¶åˆ»æœ€å¤šå…±æœ‰Â nÂ ä¸ªÂ `duplicated`Â ï¼Œä½¿ç”¨Â $O(n^2)$Â ç©ºé—´ã€‚**å› æ­¤ç©ºé—´å¤æ‚åº¦ä¸ºÂ $O(n^2)$**


