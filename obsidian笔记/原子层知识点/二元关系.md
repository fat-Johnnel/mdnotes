## 2.3 关系的运算 📚

**定义2.3.1** 设$R$为二元关系：  
(1) **定义域**（dom R）：  
$$\text{dom }R = \{x \mid \exists y \text{ 使得 } \langle x, y \rangle \in R\}$$
(2) **值域**（ran R）：  
$$\text{ran }R = \{y \mid \exists x \text{ 使得 } \langle x, y \rangle \in R\}$$
(3) **域**（fld R）：  
$$\text{fld }R = \text{dom }R \cup \text{ran }R$$

**定义2.3.4** 设$R$为二元关系，$A$为集合：  
1. **限制**（$R \upharpoonright A$）：  
$$R \upharpoonright A = \{\langle x, y \rangle \mid \langle x, y \rangle \in R \land x \in A\}$$
2. **像集**（$R[A]$）：  
$$R[A] = \text{ran}(R \upharpoonright A)$$


##### 定理2.3.4 🧪
设$F, G, H$为任意关系：  
1. **分配律（并集）**：  
$$F \circ (G \cup H) = F \circ G \cup F \circ H$$
2. $$(G \cup H) \circ F = G \circ F \cup H \circ F$$
3. **子集关系（交集）**：  
$$F \circ (G \cap H) \subseteq F \circ G \cap F \circ H$$
4. $$(G \cap H) \circ F \subseteq G \circ F \cap H \circ F$$

### 定理2.3.5 🧪
设$F$为关系，$A, B$为集合：  
1. **限制的并/交运算**：  
$$F \upharpoonright (A \cup B) = F \upharpoonright A \cup F \upharpoonright B$$
$$F \upharpoonright (A \cap B) = F \upharpoonright A \cap F \upharpoonright B$$
2. **像集的并/交运算**：  
$$F[A \cup B] = F[A] \cup F[B]$$
$$F[A \cap B] \subseteq F[A] \cap F[B]$$


### 关系幂等性定理 🔄
**定理2.3.6** 设$A$为$n$元集，$R$是$A$上的关系，则存在自然数$s \neq t$使得：  
$$R^s = R^t$$

**定理2.3.8** 若$R^s = R^t$（$s < t$）：  
1. 对任意$k \in \mathbb{N}$，有$R^{s+k} = R^{t+k}$。  
2. 对任意$k, i \in \mathbb{N}$，有$R^{s+kp+i} = R^{s+i}$（其中$p = t - s$）。  
3. 集合$S = \{R^0, R^1, \ldots, R^{t-1}\}$包含所有$R^q$（$q \in \mathbb{N}$）。  

---

## 2.4 关系的性质 🎈

**定义2.4.1** 设$R$为$A$上的关系：  
1. **自反关系**：  
$$\forall x \in A, \langle x, x \rangle \in R$$
2. **反自反关系**：  
$$\forall x \in A, \langle x, x \rangle \notin R$$



**定义2.4.2** 设$R$为$A$上的关系：  
1. **对称关系**：  
$$\forall \langle x, y \rangle \in R, \langle y, x \rangle \in R$$
2. **反对称关系**：  
$$\forall \langle x, y \rangle \in R, \langle y, x \rangle \in R \Rightarrow x = y$$

**定义2.4.3** 设$R$为$A$上的关系：  
若当$\langle x, y \rangle \in R$且$\langle y, z \rangle \in R$时，必有$\langle x, z \rangle \in R$，则称$R$为$A$上的**传递关系**。  
$$\forall x,y,z \in A, \big( (x,y) \in R \land (y,z) \in R \big) \implies (x,z) \in R$$


#### 关系性质的充要条件 🧪
**定理2.4.1** 设$R$为$A$上的关系，则：  
1. **自反性**当且仅当$I_A \subseteq R$。  
$$R \text{ 自反 } \iff I_A \subseteq R$$
2. **反自反性**当且仅当$R \cap I_A = \emptyset$。  
$$R \text{ 反自反 } \iff R \cap I_A = \varnothing$$
3. **对称性**当且仅当$R = R^{-1}$。  
$$R \text{ 对称 } \iff R = R^{-1}$$
4. **反对称性**当且仅当$R \cap R^{-1} \subseteq I_A$。  
$$R \text{ 反对称 } \iff R \cap R^{-1} \subseteq I_A$$
5. **传递性**当且仅当$R \circ R \subseteq R$。  
$$R \text{ 传递 } \iff R \circ R \subseteq R$$

---
## 2.5 关系的闭包 📚

##### 定义 2.5.1 📝  
设$R$是非空集合$A$上的关系，$R$的自反（对称或传递）闭包是$A$上的关系$R'$，满足：  
1.$R'$是自反的（对称或传递的）；  
2.$R \subseteq R'$；  
1. 对$A$上任何包含$R$的自反（对称或传递）关系$R''$，有$R' \subseteq R''$。  

一般将$R$的**自反闭包**记作$r(R)$，**对称闭包**记作$s(R)$，**传递闭包**记作$t(R)$。  


##### 定理 2.5.1 📚  
设$R$为$A$上的关系，则有：  
1. **自反闭包**：$r(R) = R \cup I_A$
 $$r(R) = R \cup I_A$$
2. **对称闭包**：$s(R) = R \cup R^{-1}$
 $$s(R) = R \cup R^{-1}$$
3. **传递闭包**：$t(R) = R \cup R^2 \cup R^3 \cup \cdots$
 $$t(R) = R \cup R^2 \cup R^3 \cup \cdots$$


#### 推论 2.5.1 📝  
设$R$为有穷集$A$上的关系，则存在正整数$r$使得：  
$$t(R) = R \cup R^2 \cup R^3 \cup \cdots \cup R^r$$
此推论表明：**有穷集上的传递闭包可通过有限次复合运算的并集表示**。


#### 沃舍尔算法 🔧  
**输入**：$M$（$R$的关系矩阵）  
**输出**：$M_t$（$t(R)$的关系矩阵）  

**算法步骤**：  
1. 将$M$赋值给$M_t$。  
2. **外层循环**：$k$从 1 到$n$
3.  **中层循环**：$i$从 1 到$n$
4.   **内层循环**：$j$从 1 到$n$
5.    更新$M_t[i,j]$：  
 $$M_t[i,j] \leftarrow M_t[i,j] \lor \left( M_t[i,k] \land M_t[k,j] \right)$$
6.   结束内层循环  
7.  结束中层循环  
8. 结束外层循环  


#### 定理 2.5.2 📚  
设$R$是非空集合$A$上的关系，则：  
1.$R$是**自反**的当且仅当$r(R) = R$。  
 $$R \text{ 自反 } \iff r(R) = R$$
2.$R$是**对称**的当且仅当$s(R) = R$。  
 $$R \text{ 对称 } \iff s(R) = R$$
3.$R$是**传递**的当且仅当$t(R) = R$。  
 $$R \text{ 传递 } \iff t(R) = R$$

---
## 2.6 等价关系与划分 📖

#### 定义2.6.1 📚  
设$R$为非空集合$A$上的关系。若$R$是**自反的**、**对称的**和**传递的**，则称$R$为$A$上的**等价关系**。若$\langle x, y \rangle \in R$，称$x$**等价于**$y$，记作$x \sim y$。  
$$R \text{ 是等价关系 } \iff R \text{ 满足自反性、对称性、传递性}$$
#### 定义2.6.2 📝  
设$R$为非空集合$A$上的等价关系，对任意$x \in A$，定义：  
$$[x]_R = \{ y \mid y \in A,\, \langle x, y \rangle \in R \}$$ 
称$[x]_R$为$x$关于$R$的**等价类**，简记为$[x]$或$\overline{x}$。  

#### 定义2.6.3 📚  
设$R$为非空集合$A$上的等价关系，以$R$的所有等价类为元素的集合称为$A$关于$R$的**商集**，记作$A/R$，即：  
$$A/R = \{ [x]_R \mid x \in A \}$$ 

#### 定义2.6.4 📝  
设$A$为非空集合，若$A$的子集族$\pi \subseteq P(A)$满足：  
1. **非空性**：$\emptyset \notin \pi$；  
2. **互不相交**：$\forall X,Y \in \pi \ (X \neq Y \implies X \cap Y = \emptyset)$；  
3. **覆盖性**：$\bigcup \pi = A$；  
则称$\pi$是$A$的一个**划分**，$\pi$中的元素称为**划分块**。  

---

## 2.7 偏序关系 📚

#### 定义2.7.1（偏序关系）
设$R$为非空集合$A$上的关系。若$R$满足：  
1. **自反性**：$\forall x \in A,\ (x,x) \in R$  
2. **反对称性**：$\forall x,y \in A,\ (x,y) \in R \land (y,x) \in R \Rightarrow x = y$  
3. **传递性**：$\forall x,y,z \in A,\ (x,y) \in R \land (y,z) \in R \Rightarrow (x,z) \in R$  

则称$R$为$A$上的**偏序关系**，记作$\leq$。当$(x,y) \in \leq$时，记作$x \leq y$，读作“$x$小于等于$y$”。


#### 定义2.7.3（全序关系）  
设$R$为非空集合$A$上的偏序关系。若$\forall x,y \in A$，$x$与$y$都是**可比**的（即$x \leq y$或$y \leq x$），则称$R$为$A$上的**全序关系**（或**线序关系**）。


#### 定义2.7.4（偏序集）  
集合$A$与其上的偏序关系$\preceq$共同构成的系统称为**偏序集**，记作：  
$$  
(A, \preceq)  
$$  
其中$\preceq$表示集合$A$中定义的偏序关系